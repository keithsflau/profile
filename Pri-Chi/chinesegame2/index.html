<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>句子接力組裝</title>
    <style>
      :root {
        color-scheme: light;
        font-family: "Noto Sans TC", "PingFang TC", "Microsoft JhengHei", sans-serif;
        --primary: #ff9f1c;
        --secondary: #2ec4b6;
        --background: #fff7e9;
        --surface: #ffffff;
        --text: #1d1d1f;
        --muted: #707070;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        background: var(--background);
        color: var(--text);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 40px 16px;
      }

      .app {
        width: min(720px, 100%);
        background: var(--surface);
        border-radius: 24px;
        box-shadow: 0 16px 32px rgba(0, 0, 0, 0.08);
        padding: 32px;
      }

      h1 {
        margin: 0 0 12px;
        font-size: 2rem;
        color: var(--primary);
        text-align: center;
      }

      .subtitle {
        margin: 0 0 24px;
        text-align: center;
        color: var(--muted);
        font-size: 1rem;
      }

      .status-bar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: rgba(46, 196, 182, 0.12);
        border-radius: 16px;
        padding: 12px 16px;
        margin-bottom: 24px;
      }

      .status-bar span {
        font-weight: 600;
      }

      .word-bank,
      .answer-area {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        min-height: 76px;
        padding: 16px;
        border-radius: 16px;
        border: 2px dashed rgba(112, 112, 112, 0.35);
        background: rgba(255, 255, 255, 0.8);
        transition: border-color 0.2s ease, background 0.2s ease;
      }

      .word-bank {
        margin-bottom: 20px;
      }

      .word-tile {
        padding: 10px 18px;
        border-radius: 999px;
        background: var(--secondary);
        color: white;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: grab;
        user-select: none;
        transition: transform 0.15s ease, box-shadow 0.15s ease;
      }

      .word-tile:active {
        cursor: grabbing;
        transform: scale(0.97);
      }

      .word-tile[data-origin="answer"] {
        background: var(--primary);
      }

      .answer-area.active {
        border-color: var(--primary);
        background: rgba(255, 159, 28, 0.08);
      }

      .controls {
        display: flex;
        justify-content: center;
        margin-top: 28px;
      }

      button {
        padding: 12px 36px;
        font-size: 1.05rem;
        font-weight: 700;
        border-radius: 999px;
        border: none;
        cursor: pointer;
        background: var(--primary);
        color: white;
        box-shadow: 0 10px 20px rgba(255, 159, 28, 0.25);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 24px rgba(255, 159, 28, 0.35);
      }

      button:active {
        transform: translateY(0);
      }

      .feedback {
        margin-top: 20px;
        text-align: center;
        font-size: 1.2rem;
        font-weight: 700;
        min-height: 1.4em;
      }

      .feedback.success {
        color: var(--secondary);
      }

      .feedback.error {
        color: #ff595e;
      }

      @media (max-width: 600px) {
        .app {
          padding: 24px 20px;
        }

        .word-tile {
          flex: 1 1 calc(50% - 12px);
          text-align: center;
        }
      }
    </style>
  </head>
  <body>
    <main class="app">
      <h1>句子接力組裝</h1>
      <p class="subtitle">把詞語方塊排好順序，組出完整的句子！</p>

      <section class="status-bar">
        <div><span id="difficultyLabel"></span></div>
        <div>題目 <span id="questionNumber"></span>/<span id="totalQuestions"></span></div>
      </section>

      <section>
        <h2 style="display:none;">詞語區</h2>
        <div id="wordBank" class="word-bank" role="listbox" aria-label="可選擇的詞語"></div>
      </section>

      <section>
        <h2 style="display:none;">答題區</h2>
        <div
          id="answerArea"
          class="answer-area"
          role="list"
          aria-label="已選擇的詞語，請依序排列"
        ></div>
      </section>

      <div class="controls">
        <button id="checkButton" type="button">檢查答案</button>
      </div>

      <p id="feedback" class="feedback" role="status" aria-live="polite"></p>
    </main>

    <script>
      const sentences = [
        {
          difficulty: "初級",
          words: ["小狗", "開心地", "搖著", "尾巴"],
        },
        {
          difficulty: "進階",
          words: ["清晨", "的", "花朵", "在", "陽光", "下", "慢慢", "綻放"],
        },
        {
          difficulty: "挑戰",
          words: ["我們", "一起", "把", "完成", "作業", "的", "好習慣", "培養起來"],
        },
      ];

      let currentIndex = 0;
      const wordBank = document.getElementById("wordBank");
      const answerArea = document.getElementById("answerArea");
      const feedback = document.getElementById("feedback");
      const checkButton = document.getElementById("checkButton");
      const difficultyLabel = document.getElementById("difficultyLabel");
      const questionNumber = document.getElementById("questionNumber");
      const totalQuestions = document.getElementById("totalQuestions");

      totalQuestions.textContent = sentences.length;

      function shuffle(array) {
        const copy = [...array];
        for (let i = copy.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [copy[i], copy[j]] = [copy[j], copy[i]];
        }
        return copy;
      }

      function resetFeedback() {
        feedback.textContent = "";
        feedback.classList.remove("success", "error");
      }

      function renderSentence(index) {
        const { difficulty, words } = sentences[index];
        difficultyLabel.textContent = `難度：${difficulty}`;
        questionNumber.textContent = index + 1;

        resetFeedback();
        wordBank.innerHTML = "";
        answerArea.innerHTML = "";

        const shuffledWords = shuffle(words);
        shuffledWords.forEach((word) => {
          const tile = createWordTile(word, "bank");
          wordBank.appendChild(tile);
        });
      }

      function createWordTile(text, origin) {
        const tile = document.createElement("button");
        tile.type = "button";
        tile.className = "word-tile";
        tile.textContent = text;
        tile.dataset.origin = origin;
        tile.draggable = true;

        tile.addEventListener("click", () => {
          if (tile.dataset.origin === "bank") {
            tile.dataset.origin = "answer";
            answerArea.appendChild(tile);
          } else {
            tile.dataset.origin = "bank";
            wordBank.appendChild(tile);
          }
        });

        tile.addEventListener("dragstart", (event) => {
          event.dataTransfer.setData("text/plain", text);
          event.dataTransfer.effectAllowed = "move";
          tile.classList.add("dragging");
        });

        tile.addEventListener("dragend", () => {
          tile.classList.remove("dragging");
        });

        return tile;
      }

      function setupDragAndDrop(container) {
        container.addEventListener("dragover", (event) => {
          event.preventDefault();
          event.dataTransfer.dropEffect = "move";
          if (container === answerArea) {
            container.classList.add("active");
          }
        });

        container.addEventListener("dragleave", () => {
          if (container === answerArea) {
            container.classList.remove("active");
          }
        });

        container.addEventListener("drop", (event) => {
          event.preventDefault();
          const wordText = event.dataTransfer.getData("text/plain");
          const draggingTile = [...document.querySelectorAll(".word-tile")].find(
            (tile) => tile.textContent === wordText && tile.classList.contains("dragging")
          );

          if (!draggingTile) return;

          if (container === answerArea) {
            draggingTile.dataset.origin = "answer";
            answerArea.appendChild(draggingTile);
            answerArea.classList.remove("active");
          } else {
            draggingTile.dataset.origin = "bank";
            wordBank.appendChild(draggingTile);
          }
        });
      }

      function collectAnswer() {
        return [...answerArea.querySelectorAll(".word-tile")].map((tile) => tile.textContent);
      }

      function checkAnswer() {
        const userAnswer = collectAnswer();
        const correctAnswer = sentences[currentIndex].words;

        if (userAnswer.length !== correctAnswer.length) {
          feedback.textContent = "再試一次";
          feedback.classList.add("error");
          return;
        }

        const isCorrect = correctAnswer.every((word, idx) => word === userAnswer[idx]);

        if (isCorrect) {
          feedback.textContent = "太棒了！";
          feedback.classList.add("success");
          setTimeout(() => {
            currentIndex = (currentIndex + 1) % sentences.length;
            renderSentence(currentIndex);
          }, 1500);
        } else {
          feedback.textContent = "再試一次";
          feedback.classList.add("error");
        }
      }

      checkButton.addEventListener("click", checkAnswer);

      ["dragenter", "dragover", "dragleave", "drop"].forEach((eventName) => {
        wordBank.addEventListener(eventName, (event) => event.preventDefault());
      });

      setupDragAndDrop(wordBank);
      setupDragAndDrop(answerArea);
      renderSentence(currentIndex);
    </script>
  </body>
</html>




