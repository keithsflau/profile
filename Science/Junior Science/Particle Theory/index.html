<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Particle Theory Simulator | HK F1 Science</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom glowing effect for Plasma */
        .plasma-glow {
            text-shadow: 0 0 10px #fff, 0 0 20px #ff00de, 0 0 30px #ff00de;
        }
        canvas {
            touch-action: none; /* Prevent scrolling on mobile while touching canvas */
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 font-sans min-h-screen flex flex-col">

    <header class="bg-blue-900 text-white p-6 shadow-lg">
        <div class="max-w-5xl mx-auto">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div>
                    <h1 class="text-3xl font-bold">States of Matter Simulator</h1>
                    <p class="text-blue-200 text-sm mt-1">Form 1 Science â€¢ Particle Theory</p>
                </div>
                <div class="mt-4 md:mt-0">
                    <span class="bg-blue-800 px-3 py-1 rounded text-xs border border-blue-600">Interactive Demo</span>
                </div>
            </div>
        </div>
    </header>

    <main class="flex-grow p-4 md:p-8 max-w-6xl mx-auto w-full grid grid-cols-1 lg:grid-cols-3 gap-8">
        
        <div class="lg:col-span-2 flex flex-col">
            <div class="bg-white p-1 rounded-xl shadow-xl border-4 border-slate-200 relative">
                <div id="temp-display" class="absolute top-4 right-4 bg-white/90 backdrop-blur px-4 py-2 rounded-lg font-mono font-bold text-blue-600 shadow border border-slate-200 z-10">
                    Low Energy
                </div>
                
                <canvas id="simCanvas" class="w-full h-[400px] bg-slate-100 rounded-lg cursor-pointer"></canvas>
                
                <div class="grid grid-cols-4 gap-2 mt-4 p-2">
                    <button onclick="setMode('solid')" id="btn-solid" class="state-btn bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-semibold transition-all transform active:scale-95 shadow-md">
                        SOLID
                    </button>
                    <button onclick="setMode('liquid')" id="btn-liquid" class="state-btn bg-slate-200 hover:bg-cyan-500 hover:text-white text-slate-700 py-3 rounded-lg font-semibold transition-all transform active:scale-95">
                        LIQUID
                    </button>
                    <button onclick="setMode('gas')" id="btn-gas" class="state-btn bg-slate-200 hover:bg-orange-500 hover:text-white text-slate-700 py-3 rounded-lg font-semibold transition-all transform active:scale-95">
                        GAS
                    </button>
                    <button onclick="setMode('plasma')" id="btn-plasma" class="state-btn bg-slate-200 hover:bg-purple-600 hover:text-white text-slate-700 py-3 rounded-lg font-semibold transition-all transform active:scale-95">
                        PLASMA
                    </button>
                </div>
            </div>
        </div>

        <div class="lg:col-span-1">
            <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200 h-full">
                <h2 id="info-title" class="text-2xl font-bold text-blue-900 mb-4 border-b pb-2">Solid State</h2>
                
                <div class="space-y-4">
                    <div>
                        <h3 class="font-bold text-slate-500 text-xs uppercase tracking-wider">Arrangement</h3>
                        <p id="info-arrangement" class="text-slate-800">Regular pattern, packed closely together.</p>
                    </div>
                    
                    <div>
                        <h3 class="font-bold text-slate-500 text-xs uppercase tracking-wider">Movement</h3>
                        <p id="info-movement" class="text-slate-800">Vibrate about fixed positions. They do not move from place to place.</p>
                    </div>

                    <div>
                        <h3 class="font-bold text-slate-500 text-xs uppercase tracking-wider">Energy</h3>
                        <p id="info-energy" class="text-slate-800">Very low kinetic energy.</p>
                    </div>

                    <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500 mt-6">
                        <h3 class="font-bold text-blue-800 text-sm">ðŸ’¡ Engineer's Analogy</h3>
                        <p id="info-analogy" class="text-sm text-blue-700 mt-1">Like students sitting in a classroom. You can wiggle in your seat, but you cannot leave your desk.</p>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <footer class="bg-slate-800 text-slate-400 py-6 text-center text-sm">
        <p>Designed for HK Form 1 Integrated Science â€¢ Educational Use Only</p>
    </footer>

    <script>
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        let width, height;
        let particles = [];
        let animationId;
        let currentMode = 'solid';

        // Configuration for different states
        const configs = {
            solid: { 
                count: 100, 
                speed: 0.5, 
                color: '#2563eb', // Blue
                tempText: '-20Â°C (Freezing)',
                bg: '#f1f5f9'
            },
            liquid: { 
                count: 80, 
                speed: 2, 
                color: '#06b6d4', // Cyan
                tempText: '25Â°C (Room Temp)',
                bg: '#ecfeff'
            },
            gas: { 
                count: 40, 
                speed: 6, 
                color: '#f97316', // Orange
                tempText: '100Â°C+ (Boiling)',
                bg: '#fff7ed'
            },
            plasma: { 
                count: 40, 
                speed: 12, 
                color: '#9333ea', // Purple
                tempText: '5000Â°C+ (Ionized)',
                bg: '#1e1b4b' // Dark background for glow
            }
        };

        // Resize canvas handling
        function resize() {
            const rect = canvas.getBoundingClientRect();
            // Set actual canvas size to match display size for sharpness
            canvas.width = rect.width;
            canvas.height = rect.height;
            width = canvas.width;
            height = canvas.height;
            initParticles();
        }
        window.addEventListener('resize', resize);

        class Particle {
            constructor(mode) {
                this.radius = width < 500 ? 6 : 8; // Responsive particle size
                this.mode = mode;
                this.reset();
            }

            reset() {
                if (this.mode === 'solid') {
                    // Grid logic handled in init
                    this.vx = (Math.random() - 0.5) * 0.5;
                    this.vy = (Math.random() - 0.5) * 0.5;
                } else if (this.mode === 'liquid') {
                    this.x = Math.random() * width;
                    // Liquid stays mostly in bottom 60%
                    this.y = height - (Math.random() * (height * 0.6)) - this.radius;
                    this.vx = (Math.random() - 0.5) * 2;
                    this.vy = (Math.random() - 0.5) * 2;
                } else {
                    // Gas and Plasma fill everywhere
                    this.x = Math.random() * width;
                    this.y = Math.random() * height;
                    const speed = configs[this.mode].speed;
                    this.vx = (Math.random() - 0.5) * speed;
                    this.vy = (Math.random() - 0.5) * speed;
                }
                
                // Anchor point for solids to vibrate around
                this.anchorX = this.x;
                this.anchorY = this.y;
            }

            update() {
                if (this.mode === 'solid') {
                    // Solid: Vibrate around anchor
                    this.x = this.anchorX + Math.sin(Date.now() / 100 + this.anchorX) * 2;
                    this.y = this.anchorY + Math.cos(Date.now() / 100 + this.anchorY) * 2;
                } 
                else if (this.mode === 'liquid') {
                    // Liquid: Move freely but constrained to container bottom, simulate sliding
                    this.x += this.vx;
                    this.y += this.vy;

                    // Wall collisions
                    if (this.x < this.radius || this.x > width - this.radius) this.vx *= -1;
                    
                    // Floor collision
                    if (this.y > height - this.radius) {
                        this.y = height - this.radius;
                        this.vy *= -1;
                    }
                    
                    // "Surface" pseudo-collision (to keep volume roughly fixed)
                    const surfaceLevel = height * 0.4; 
                    if (this.y < surfaceLevel) {
                        this.vy += 0.2; // heavy gravity push back down
                    } else {
                        this.vy += 0.05; // slight gravity
                    }
                } 
                else {
                    // Gas & Plasma: Bounce everywhere
                    this.x += this.vx;
                    this.y += this.vy;

                    if (this.x < this.radius || this.x > width - this.radius) this.vx *= -1;
                    if (this.y < this.radius || this.y > height - this.radius) this.vy *= -1;
                }
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fillStyle = configs[currentMode].color;
                
                // Special effects for Plasma
                if (currentMode === 'plasma') {
                    ctx.shadowBlur = 15;
                    ctx.shadowColor = configs[currentMode].color;
                    ctx.fillStyle = '#ffffff'; // White core
                } else {
                    ctx.shadowBlur = 0;
                }
                
                ctx.fill();
                ctx.closePath();
            }
        }

        function initParticles() {
            particles = [];
            const config = configs[currentMode];
            
            if (currentMode === 'solid') {
                // Create a grid for solids
                const cols = Math.floor(Math.sqrt(config.count));
                const spacing = 25;
                const startX = (width - (cols * spacing)) / 2;
                const startY = (height - (cols * spacing)) / 2;
                
                let created = 0;
                for(let i=0; i<cols*2; i++) {
                    for(let j=0; j<cols; j++) {
                        if (created >= config.count) break;
                        const p = new Particle(currentMode);
                        p.x = startX + (j * spacing);
                        p.y = startY + (i * spacing);
                        p.anchorX = p.x;
                        p.anchorY = p.y;
                        particles.push(p);
                        created++;
                    }
                }
            } else {
                for (let i = 0; i < config.count; i++) {
                    particles.push(new Particle(currentMode));
                }
            }
        }

        function animate() {
            ctx.clearRect(0, 0, width, height);
            
            // Draw Lightning for Plasma
            if (currentMode === 'plasma' && Math.random() > 0.9) {
                ctx.beginPath();
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
                ctx.lineWidth = 2;
                ctx.moveTo(Math.random() * width, Math.random() * height);
                ctx.lineTo(Math.random() * width, Math.random() * height);
                ctx.stroke();
            }

            particles.forEach(p => {
                p.update();
                p.draw();
            });
            requestAnimationFrame(animate);
        }

        // UI Logic
        function setMode(mode) {
            currentMode = mode;
            
            // Update Buttons
            document.querySelectorAll('.state-btn').forEach(btn => {
                btn.classList.remove('bg-blue-600', 'text-white', 'ring-4', 'ring-blue-300');
                btn.classList.add('bg-slate-200', 'text-slate-700');
            });
            
            const activeBtn = document.getElementById(`btn-${mode}`);
            activeBtn.classList.remove('bg-slate-200', 'text-slate-700');
            
            // Color mapping for buttons
            const colors = {
                solid: 'bg-blue-600',
                liquid: 'bg-cyan-500',
                gas: 'bg-orange-500',
                plasma: 'bg-purple-600'
            };
            activeBtn.classList.add(colors[mode], 'text-white', 'ring-4', 'ring-blue-100');

            // Update Canvas Background
            canvas.style.backgroundColor = configs[mode].bg;

            // Update Text Content
            updateInfo(mode);
            
            // Reset Simulation
            initParticles();
        }

        function updateInfo(mode) {
            const data = {
                solid: {
                    title: "Solid State",
                    arrange: "Packed closely in a regular pattern (Lattice).",
                    move: "Particles vibrate around fixed positions. They cannot move freely.",
                    energy: "Lowest kinetic energy. Strongest forces of attraction.",
                    analogy: "Like students sitting in assigned seats in a classroom. You can wiggle, but you can't change seats.",
                    temp: "Low Temp (Freezing)"
                },
                liquid: {
                    title: "Liquid State",
                    arrange: "Packed closely but irregular (Random). Takes shape of container bottom.",
                    move: "Particles slide past one another. They flow freely.",
                    energy: "Moderate kinetic energy. Forces are strong enough to keep them together but weak enough to allow flow.",
                    analogy: "Like a crowded party or hallway. You are touching others, but you can push past them to move around.",
                    temp: "Medium Temp (Room)"
                },
                gas: {
                    title: "Gas State",
                    arrange: "Far apart and random. No fixed shape or volume.",
                    move: "Move quickly and randomly in all directions. Frequent collisions.",
                    energy: "High kinetic energy. Negligible forces of attraction.",
                    analogy: "Like players on a football field running in random directions, occasionally bumping into each other.",
                    temp: "High Temp (Boiling)"
                },
                plasma: {
                    title: "Plasma State (Ionized Gas)",
                    arrange: "Similar to gas but particles are broken apart.",
                    move: "Extremely violent and fast movement.",
                    energy: "Super-high energy! Electrons are ripped off atoms (Ionization).",
                    analogy: "Imagine the 'Gas' football players running so fast that their shoes and hats fly off! Found in Lightning and Stars.",
                    temp: "Extreme Temp (Stars)"
                }
            };

            const info = data[mode];
            document.getElementById('info-title').innerText = info.title;
            document.getElementById('info-title').className = `text-2xl font-bold mb-4 border-b pb-2 ${mode === 'plasma' ? 'text-purple-600' : 'text-blue-900'}`;
            document.getElementById('info-arrangement').innerText = info.arrange;
            document.getElementById('info-movement').innerText = info.move;
            document.getElementById('info-energy').innerText = info.energy;
            document.getElementById('info-analogy').innerText = info.analogy;
            document.getElementById('temp-display').innerText = info.temp;
            
            const tempDisplay = document.getElementById('temp-display');
            if(mode === 'plasma') {
                tempDisplay.className = "absolute top-4 right-4 bg-purple-900/90 text-white px-4 py-2 rounded-lg font-mono font-bold shadow border border-purple-500 z-10 plasma-glow";
            } else {
                tempDisplay.className = "absolute top-4 right-4 bg-white/90 backdrop-blur px-4 py-2 rounded-lg font-mono font-bold text-blue-600 shadow border border-slate-200 z-10";
            }
        }

        // Start
        setTimeout(() => {
            resize();
            animate();
            setMode('solid'); // Default state
        }, 100);

    </script>
</body>
</html>